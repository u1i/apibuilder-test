'use strict';

var doT = require('dot');

function format(req) {
	var template = req.params.template;
	var data = req.params.data;
	return doT.template(template)(data);
}

exports = module.exports = {
	formatStr(req, cb) {
		try {
			cb.next(null, format(req));
		} catch (e) {
			cb.error(null, e);
		}
	},
	formatObj(req, cb) {
		var val = req.params.template;
		try {
			val = format(req);
			cb.next(null, JSON.parse(val));
		} catch (e) {
			cb.error(null, e);
		}
	}
};